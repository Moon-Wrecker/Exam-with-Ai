<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <div class="admin-wrapper">
        <!-- Sidebar -->
        <nav class="admin-sidebar">
            <div class="sidebar-header">
                <h3>Quiz Master</h3>
                <p>Admin Panel</p>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="{{ url_for('admin_dashboard') }}">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('manage_subjects') }}">
                        <i class="bi bi-book"></i> Subjects
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('manage_chapters') }}">
                        <i class="bi bi-journals"></i> Chapters
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('manage_quizzes') }}">
                        <i class="bi bi-question-circle"></i> Quizzes
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('manage_users') }}">
                        <i class="bi bi-people"></i> Users
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('summary') }}">
                        <i class="bi bi-graph-up"></i> Summary
                    </a>
                </li>
                <li class="nav-item mt-4">
                    <a class="nav-link" href="{{ url_for('logout') }}">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <div class="admin-content">
            <!-- Top Navbar -->
            <nav class="admin-navbar">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="search-container">
                        <i class="bi bi-search"></i>
                        <input type="text" id="searchInput" class="form-control" placeholder="Search users, subjects, quizzes...">
                        <div class="search-results">
                            <div class="search-section">
                                <h6><i class="bi bi-people"></i> Users</h6>
                                <div id="userResults"></div>
                            </div>
                            <div class="search-section">
                                <h6><i class="bi bi-book"></i> Subjects</h6>
                                <div id="subjectResults"></div>
                            </div>
                            <div class="search-section">
                                <h6><i class="bi bi-question-circle"></i> Quizzes</h6>
                                <div id="quizResults"></div>
                            </div>
                        </div>
                    </div>
                    <div class="admin-profile">
                        <span>Welcome Admin</span>
                    </div>
                </div>
            </nav>

            <!-- Dashboard Content -->
            <div class="container-fluid py-4">
                <div class="row">
                    <div class="col-md-3">
                        <div class="stats-card">
                            <i class="bi bi-people"></i>
                            <h3>{{ users|length }}</h3>
                            <p>Total Users</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <i class="bi bi-book"></i>
                            <h3>{{ subjects|length }}</h3>
                            <p>Total Subjects</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <i class="bi bi-question-circle"></i>
                            <h3>{{ quizzes|length }}</h3>
                            <p>Total Quizzes</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <i class="bi bi-check-circle"></i>
                            <h3>{{ completed_quizzes }}</h3>
                            <p>Completed Quizzes</p>
                        </div>
                    </div>
                </div>

                <!-- Recent Activities -->
                <div class="card mt-4">
                    <div class="card-header bg-white">
                        <h5 class="mb-0"><i class="bi bi-activity me-2"></i>Recent Activities</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Action</th>
                                        <th>Subject</th>
                                        <th>Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for activity in recent_activities %}
                                    <tr>
                                        <td><i class="bi bi-person me-2"></i>{{ activity.user }}</td>
                                        <td><i class="bi bi-check-circle me-2"></i>{{ activity.action }}</td>
                                        <td><i class="bi bi-book me-2"></i>{{ activity.subject }}</td>
                                        <td><i class="bi bi-calendar me-2"></i>{{ activity.date }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.querySelector('.search-results');
            const userResults = document.getElementById('userResults');
            const subjectResults = document.getElementById('subjectResults');
            const quizResults = document.getElementById('quizResults');
            let searchTimeout;

            searchInput.addEventListener('focus', () => {
                if (searchInput.value.trim().length >= 2) {
                    searchResults.style.display = 'block';
                }
            });

            document.addEventListener('click', (e) => {
                if (!searchResults.contains(e.target) && e.target !== searchInput) {
                    searchResults.style.display = 'none';
                }
            });

            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                const query = this.value.trim();
                
                if (query.length < 2) {
                    searchResults.style.display = 'none';
                    return;
                }

                searchTimeout = setTimeout(() => {
                    fetch(`/admin/search?q=${encodeURIComponent(query)}`)
                        .then(response => response.json())
                        .then(data => {
                            userResults.innerHTML = data.users.length ? 
                                data.users.map(user => `
                                    <div class="search-item" onclick="window.location.href='/admin/users?search=${encodeURIComponent(user.name)}'">
                                        <i class="bi bi-person"></i>
                                        ${user.name} <small class="text-muted">(${user.email})</small>
                                    </div>
                                `).join('') : 
                                '<div class="p-2">No users found</div>';

                            subjectResults.innerHTML = data.subjects.length ?
                                data.subjects.map(subject => `
                                    <div class="search-item" onclick="window.location.href='/admin/subjects?search=${encodeURIComponent(subject.name)}'">
                                        <i class="bi bi-book"></i>
                                        ${subject.name}
                                    </div>
                                `).join('') :
                                '<div class="p-2">No subjects found</div>';

                            quizResults.innerHTML = data.quizzes.length ?
                                data.quizzes.map(quiz => `
                                    <div class="search-item" onclick="window.location.href='/admin/quizzes?search=${encodeURIComponent(quiz.subject + " - " + quiz.chapter)}'">
                                        <i class="bi bi-question-circle"></i>
                                        ${quiz.subject} - ${quiz.chapter} <small class="text-muted">(${quiz.date})</small>
                                    </div>
                                `).join('') :
                                '<div class="p-2">No quizzes found</div>';

                            searchResults.style.display = 'block';
                        })
                        .catch(error => {
                            console.error('Search error:', error);
                        });
                }, 300);
            });
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter Management - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row">
            <div class="col-md-8">
                <h2>Chapters</h2>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Subject</th>
                                <th>Chapter Name</th>
                                <th>Description</th>
                                <th>Quizzes</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for chapter in chapters %}
                            <tr>
                                <td>{{ chapter.subject.name }}</td>
                                <td>{{ chapter.name }}</td>
                                <td>{{ chapter.description }}</td>
                                <td>{{ chapter.quizzes|length }}</td>
                                <td>
                                    <a href="{{ url_for('edit_chapter', chapter_id=chapter.id) }}" class="btn btn-sm btn-primary">
                                        <i class="bi bi-pencil"></i> Edit
                                    </a>
                                    <form action="{{ url_for('delete_chapter', chapter_id=chapter.id) }}" 
                                          method="POST" style="display: inline;"
                                          onsubmit="return confirm('Are you sure you want to delete this chapter?')">
                                        <button type="submit" class="btn btn-sm btn-danger">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3>Add New Chapter</h3>
                    </div>
                    <div class="card-body">
                        <form method="POST">
                            <div class="mb-3">
                                <label for="subject_id" class="form-label">Subject</label>
                                <select class="form-select" id="subject_id" name="subject_id" required>
                                    <option value="">Select Subject</option>
                                    {% for subject in subjects %}
                                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="name" class="form-label">Chapter Name</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Chapter</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .navbar {
            background-color: #2c3e50 !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
            padding: 0.5rem 1rem;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
        .card {
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-2px);
        }
        .section-title {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }
        .search-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('dashboard') }}">Quiz Master</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('dashboard') }}">
                            <i class="bi bi-house-door"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_scores') }}">
                            <i class="bi bi-trophy"></i> Scores
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_summary') }}">
                            <i class="bi bi-graph-up"></i> Summary
                        </a>
                    </li>
                </ul>
                <div class="d-flex align-items-center">
                    <span class="text-light me-3">
                        <i class="bi bi-person-circle"></i> {{ current_user.full_name }}
                    </span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline-light">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Search Section -->
        <div class="search-container">
            <form method="GET" action="{{ url_for('dashboard') }}">
                <div class="input-group">
                    <input type="text" class="form-control" name="search" 
                           placeholder="Search quizzes by subject, chapter or topic..." 
                           value="{{ search_query }}">
                    <button class="btn btn-primary" type="submit">
                        <i class="bi bi-search"></i> Search
                    </button>
                </div>
            </form>
        </div>

        <!-- Upcoming Quizzes Section -->
        <h2 class="section-title">
            <i class="bi bi-calendar-event"></i> Upcoming Quizzes
        </h2>
        {% if upcoming_quizzes %}
            <div class="row">
                {% for quiz_data in upcoming_quizzes %}
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title text-primary">{{ quiz_data.quiz.chapter.subject.name }}</h5>
                                <h6 class="card-subtitle mb-2 text-muted">{{ quiz_data.quiz.chapter.name }}</h6>
                                <div class="card-text mt-3">
                                    <p><i class="bi bi-calendar"></i> {{ quiz_data.quiz.date_of_quiz.strftime('%Y-%m-%d %H:%M') }}</p>
                                    <p><i class="bi bi-clock"></i> {{ quiz_data.quiz.time_duration }} minutes</p>
                                    {% if quiz_data.quiz.remarks %}
                                        <p><i class="bi bi-info-circle"></i> {{ quiz_data.quiz.remarks }}</p>
                                    {% endif %}
                                </div>
                                {% if quiz_data.is_available %}
                                    {% if quiz_data.has_taken %}
                                        <button class="btn btn-success w-100 mt-3" disabled>
                                            <i class="bi bi-check-circle"></i> Completed
                                        </button>
                                    {% else %}
                                        <a href="{{ url_for('start_quiz', quiz_id=quiz_data.quiz.id) }}" 
                                           class="btn btn-primary w-100 mt-3">
                                            <i class="bi bi-play-circle"></i> Start Quiz
                                        </a>
                                    {% endif %}
                                {% else %}
                                    <button class="btn btn-secondary w-100 mt-3" disabled>
                                        <i class="bi bi-lock"></i> Not Yet Available
                                    </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Past Quizzes Section -->
        <h2 class="section-title mt-5">
            <i class="bi bi-clock-history"></i> Past Quizzes
        </h2>
        {% if past_quizzes %}
            <div class="row">
                {% for quiz_data in past_quizzes %}
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title text-primary">{{ quiz_data.quiz.chapter.subject.name }}</h5>
                                <h6 class="card-subtitle mb-2 text-muted">{{ quiz_data.quiz.chapter.name }}</h6>
                                <div class="card-text mt-3">
                                    <p><i class="bi bi-calendar"></i> {{ quiz_data.quiz.date_of_quiz.strftime('%Y-%m-%d %H:%M') }}</p>
                                    <p><i class="bi bi-clock"></i> {{ quiz_data.quiz.time_duration }} minutes</p>
                                    {% if quiz_data.has_taken %}
                                        <p><i class="bi bi-award"></i> Your Score: {{ quiz_data.score }}%</p>
                                    {% endif %}
                                </div>
                                {% if not quiz_data.has_taken %}
                                    <a href="{{ url_for('start_quiz', quiz_id=quiz_data.quiz.id) }}" 
                                       class="btn btn-primary w-100 mt-3">
                                        <i class="bi bi-play-circle"></i> Take Quiz
                                    </a>
                                {% else %}
                                    <button class="btn btn-success w-100 mt-3" disabled>
                                        <i class="bi bi-check-circle"></i> Completed
                                    </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit - Quiz Master Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Edit {{ item_type|title }}</h5>
                    </div>
                    <div class="card-body">
                        <form method="POST">
                            {% if item_type == 'subject' %}
                                <div class="mb-3">
                                    <label for="name" class="form-label">Subject Name</label>
                                    <input type="text" class="form-control" id="name" name="name" value="{{ item.name }}" required>
                                </div>
                                <div class="mb-3">
                                    <label for="description" class="form-label">Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="3">{{ item.description }}</textarea>
                                </div>
                            {% elif item_type == 'chapter' %}
                                <div class="mb-3">
                                    <label for="name" class="form-label">Chapter Name</label>
                                    <input type="text" class="form-control" id="name" name="name" value="{{ item.name }}" required>
                                </div>
                                <div class="mb-3">
                                    <label for="description" class="form-label">Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="3">{{ item.description }}</textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="subject_id" class="form-label">Subject</label>
                                    <select class="form-select" id="subject_id" name="subject_id" required>
                                        {% for subject in subjects %}
                                            <option value="{{ subject.id }}" {% if subject.id == item.subject_id %}selected{% endif %}>
                                                {{ subject.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% elif item_type == 'quiz' %}
                                <div class="mb-3">
                                    <label for="chapter_id" class="form-label">Chapter</label>
                                    <select class="form-select" id="chapter_id" name="chapter_id" required>
                                        {% for chapter in chapters %}
                                            <option value="{{ chapter.id }}" {% if chapter.id == item.chapter_id %}selected{% endif %}>
                                                {{ chapter.subject.name }} - {{ chapter.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="date_of_quiz" class="form-label">Quiz Date & Time</label>
                                    <input type="datetime-local" class="form-control" id="date_of_quiz" name="date_of_quiz" 
                                           value="{{ item.date_of_quiz.strftime('%Y-%m-%dT%H:%M') }}" required>
                                </div>
                                <div class="mb-3">
                                    <label for="time_duration" class="form-label">Duration (minutes)</label>
                                    <input type="number" class="form-control" id="time_duration" name="time_duration" 
                                           value="{{ item.time_duration }}" required min="1">
                                </div>
                                <div class="mb-3">
                                    <label for="remarks" class="form-label">Remarks</label>
                                    <textarea class="form-control" id="remarks" name="remarks" rows="2">{{ item.remarks }}</textarea>
                                </div>
                            {% endif %}
                            <div class="d-flex justify-content-between">
                                {% if item_type == 'subject' %}
                                    <a href="{{ url_for('manage_subjects') }}" class="btn btn-secondary">Cancel</a>
                                {% elif item_type == 'chapter' %}
                                    <a href="{{ url_for('manage_chapters') }}" class="btn btn-secondary">Cancel</a>
                                {% elif item_type == 'quiz' %}
                                    <a href="{{ url_for('manage_quizzes') }}" class="btn btn-secondary">Cancel</a>
                                {% endif %}
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master - Your Path to Knowledge</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">Quiz Master</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#features">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('login') }}">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn btn-custom ms-2" href="{{ url_for('register') }}">Get Started</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="hero-heading animate-float">Master Your Knowledge Through Interactive Quizzes</h1>
                    <p class="hero-text">Join thousands of learners who trust Quiz Master for their exam preparation. Comprehensive quizzes, instant feedback, and personalized learning paths.</p>
                    <a href="{{ url_for('register') }}" class="btn btn-custom btn-lg">Start Learning Now</a>
                </div>
                <div class="col-lg-6">
                    <div class="glass-card animate-float">
                        <div class="row text-center">
                            <div class="col-6 mb-4">
                                <div class="stats-number">1000+</div>
                                <div class="stats-text">Active Quizzes</div>
                            </div>
                            <div class="col-6 mb-4">
                                <div class="stats-number">50+</div>
                                <div class="stats-text">Subjects</div>
                            </div>
                            <div class="col-6">
                                <div class="stats-number">10K+</div>
                                <div class="stats-text">Students</div>
                            </div>
                            <div class="col-6">
                                <div class="stats-number">95%</div>
                                <div class="stats-text">Success Rate</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="container py-5" id="features">
        <div class="features-grid">
            <div class="glass-card">
                <div class="feature-icon">
                    <i class="bi bi-book-half fs-4"></i>
                </div>
                <h3>Multiple Subjects</h3>
                <p>Access quizzes across various subjects and topics. Learn at your own pace.</p>
            </div>
            <div class="glass-card">
                <div class="feature-icon">
                    <i class="bi bi-graph-up fs-4"></i>
                </div>
                <h3>Track Progress</h3>
                <p>Monitor your performance with detailed analytics and progress tracking.</p>
            </div>
            <div class="glass-card">
                <div class="feature-icon">
                    <i class="bi bi-shield-check fs-4"></i>
                </div>
                <h3>Expert Verified</h3>
                <p>All questions are verified by subject matter experts for accuracy.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center">
        <div class="container">
            <p>&copy; 2025 Quiz Master. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<!-- templates/login.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Login</h4>
                    </div>
                    <div class="card-body">
                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                    <div class="alert alert-{{ category if category != '_' else 'danger' }} alert-dismissible fade show">
                                        {{ message }}
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                        
                        <form method="POST" action="{{ url_for('login') }}">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">Login</button>
                            </div>
                        </form>
                        <div class="text-center mt-3">
                            <p>Don't have an account? <a href="{{ url_for('register') }}">Register here</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Questions - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row">
            <div class="col-12 mb-4">
                <h2>Questions for {{ quiz.chapter.subject.name }} - {{ quiz.chapter.name }}</h2>
                <p>Quiz Duration: {{ quiz.time_duration }} minutes</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5>Questions List</h5>
                    </div>
                    <div class="card-body">
                        {% if quiz.questions %}
                            {% for question in quiz.questions %}
                                <div class="question-card mb-3 p-3 border rounded">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <div>
                                            <h6>Question {{ loop.index }}</h6>
                                            <p>{{ question.question_statement }}</p>
                                            <ol type="A">
                                                <li {% if question.correct_option == 1 %}class="text-success fw-bold"{% endif %}>
                                                    {{ question.option1 }}
                                                </li>
                                                <li {% if question.correct_option == 2 %}class="text-success fw-bold"{% endif %}>
                                                    {{ question.option2 }}
                                                </li>
                                                <li {% if question.correct_option == 3 %}class="text-success fw-bold"{% endif %}>
                                                    {{ question.option3 }}
                                                </li>
                                                <li {% if question.correct_option == 4 %}class="text-success fw-bold"{% endif %}>
                                                    {{ question.option4 }}
                                                </li>
                                            </ol>
                                        </div>
                                        <form action="{{ url_for('delete_question', question_id=question.id) }}" 
                                              method="POST"
                                              onsubmit="return confirm('Are you sure you want to delete this question?')">
                                            <button type="submit" class="btn btn-sm btn-danger">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            {% endfor %}
                        {% else %}
                            <p class="text-muted">No questions added yet.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5>Add New Question</h5>
                    </div>
                    <div class="card-body">
                        <form method="POST">
                            <div class="mb-3">
                                <label for="question_statement" class="form-label">Question</label>
                                <textarea class="form-control" id="question_statement" name="question_statement" rows="3" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="option1" class="form-label">Option A</label>
                                <input type="text" class="form-control" id="option1" name="option1" required>
                            </div>
                            <div class="mb-3">
                                <label for="option2" class="form-label">Option B</label>
                                <input type="text" class="form-control" id="option2" name="option2" required>
                            </div>
                            <div class="mb-3">
                                <label for="option3" class="form-label">Option C</label>
                                <input type="text" class="form-control" id="option3" name="option3" required>
                            </div>
                            <div class="mb-3">
                                <label for="option4" class="form-label">Option D</label>
                                <input type="text" class="form-control" id="option4" name="option4" required>
                            </div>
                            <div class="mb-3">
                                <label for="correct_option" class="form-label">Correct Option</label>
                                <select class="form-select" id="correct_option" name="correct_option" required>
                                    <option value="">Select correct option</option>
                                    <option value="1">Option A</option>
                                    <option value="2">Option B</option>
                                    <option value="3">Option C</option>
                                    <option value="4">Option D</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Add Question</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Result - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('dashboard') }}">Quiz Master</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dashboard') }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_scores') }}">Scores</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_summary') }}">Summary</a>
                    </li>
                </ul>
                <div class="ms-auto d-flex align-items-center">
                    <span class="text-light me-3">Welcome, {{ current_user.full_name }}</span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline-light">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Quiz Scores</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>No. of Questions</th>
                                <th>Date</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{ attempt.quiz.id }}</td>
                                <td>{{ attempt.quiz.questions|length }}</td>
                                <td>{{ attempt.time_stamp_of_attempt.strftime('%d/%m/%Y') }}</td>
                                <td>{{ attempt.score|round|int }}/100</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer text-center">
                <a href="{{ url_for('user_scores') }}" class="btn btn-primary">Back to Scores</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Management - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row">
            <div class="col-md-8">
                <h2>Quizzes</h2>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Subject</th>
                                <th>Chapter</th>
                                <th>Date</th>
                                <th>Duration</th>
                                <th>Questions</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for quiz in quizzes %}
                            <tr>
                                <td>{{ quiz.chapter.subject.name }}</td>
                                <td>{{ quiz.chapter.name }}</td>
                                <td>{{ quiz.date_of_quiz.strftime('%Y-%m-%d %H:%M') }}</td>
                                <td>{{ quiz.time_duration }} minutes</td>
                                <td>{{ quiz.questions|length }}</td>
                                <td>
                                    <a href="{{ url_for('manage_questions', quiz_id=quiz.id) }}" class="btn btn-sm btn-info">
                                        <i class="bi bi-question-circle"></i> Questions
                                    </a>
                                    <a href="{{ url_for('edit_quiz', quiz_id=quiz.id) }}" class="btn btn-sm btn-primary">
                                        <i class="bi bi-pencil"></i> Edit
                                    </a>
                                    <form action="{{ url_for('delete_quiz', quiz_id=quiz.id) }}" 
                                          method="POST" style="display: inline;"
                                          onsubmit="return confirm('Are you sure you want to delete this quiz?')">
                                        <button type="submit" class="btn btn-sm btn-danger">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3>Add New Quiz</h3>
                    </div>
                    <div class="card-body">
                        <form method="POST">
                            <div class="mb-3">
                                <label for="chapter_id" class="form-label">Chapter</label>
                                <select class="form-select" id="chapter_id" name="chapter_id" required>
                                    <option value="">Select Chapter</option>
                                    {% for chapter in chapters %}
                                    <option value="{{ chapter.id }}">{{ chapter.subject.name }} - {{ chapter.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="date_of_quiz" class="form-label">Quiz Date & Time</label>
                                <input type="datetime-local" class="form-control" id="date_of_quiz" name="date_of_quiz" required>
                            </div>
                            <div class="mb-3">
                                <label for="time_duration" class="form-label">Duration (minutes)</label>
                                <input type="number" class="form-control" id="time_duration" name="time_duration" required min="1">
                            </div>
                            <div class="mb-3">
                                <label for="remarks" class="form-label">Remarks</label>
                                <textarea class="form-control" id="remarks" name="remarks" rows="2"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Quiz</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!-- templates/register.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master - Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Register</h3>
                    </div>
                    <div class="card-body">
                        {% with messages = get_flashed_messages() %}
                        <!-- {% with messages = get_flashed_messages(with_categories=true) %} -->
                            {% if messages %}
                                {% for message in messages %}
                                    <div class="alert alert-danger">{{ message }}</div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                        <form method="POST">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>
                            <div class="mb-3">
                                <label for="full_name" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="full_name" name="full_name" required>
                            </div>
                            <div class="mb-3">
                                <label for="qualification" class="form-label">Qualification</label>
                                <select class="form-control" id="qualification" name="qualification" required>
                                    <option value="" disabled selected>Select your qualification</option>
                                    <option value="Qualifiers">Qualifiers</option>
                                    <option value="Foundation">Foundation</option>
                                    <option value="Diploma">Diploma</option>
                                    <option value="B.Sc">B.Sc</option>
                                    <option value="B.S">B.S</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="date_of_birth" class="form-label">Date of Birth</label>
                                <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Register</button>
                        </form>
                        <p class="text-center mt-3">
                            Already have an account? <a href="{{ url_for('login') }}">Login here</a>
                        </p>
                        {% endwith %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<!-- templates/register.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master - Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-center">Register</h3>
                    </div>
                    <div class="card-body">
                        {% with messages = get_flashed_messages() %}
                        <!-- {% with messages = get_flashed_messages(with_categories=true) %} -->
                            {% if messages %}
                                {% for message in messages %}
                                    <div class="alert alert-danger">{{ message }}</div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                        <form method="POST">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>
                            <div class="mb-3">
                                <label for="full_name" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="full_name" name="full_name" required>
                            </div>
                            <div class="mb-3">
                                <label for="qualification" class="form-label">Qualification</label>
                                <select class="form-control" id="qualification" name="qualification" required>
                                    <option value="" disabled selected>Select your qualification</option>
                                    <option value="Qualifiers">Qualifiers</option>
                                    <option value="Foundation">Foundation</option>
                                    <option value="Diploma">Diploma</option>
                                    <option value="B.Sc">B.Sc</option>
                                    <option value="B.S">B.S</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="date_of_birth" class="form-label">Date of Birth</label>
                                <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Register</button>
                        </form>
                        <p class="text-center mt-3">
                            Already have an account? <a href="{{ url_for('login') }}">Login here</a>
                        </p>
                        {% endwith %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - {{ quiz.chapter.subject.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .question-card {
            margin-bottom: 2rem;
        }
        #timer {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div id="timer" class="alert alert-info">
            Time Remaining: <span id="time">{{ quiz.time_duration }}:00</span>
        </div>

        <h2 class="mb-4">{{ quiz.chapter.subject.name }} - {{ quiz.chapter.name }}</h2>

        <form id="quizForm" method="POST" action="{{ url_for('submit_quiz') }}">
            {% for question in quiz.questions %}
            <div class="card question-card">
                <div class="card-body">
                    <h5 class="card-title">Question {{ loop.index }}</h5>
                    <p class="card-text">{{ question.question_statement }}</p>
                    
                    <div class="options">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="answer_{{ question.id }}" 
                                   id="q{{ question.id }}_1" value="1" required>
                            <label class="form-check-label" for="q{{ question.id }}_1">
                                {{ question.option1 }}
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="answer_{{ question.id }}" 
                                   id="q{{ question.id }}_2" value="2">
                            <label class="form-check-label" for="q{{ question.id }}_2">
                                {{ question.option2 }}
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="answer_{{ question.id }}" 
                                   id="q{{ question.id }}_3" value="3">
                            <label class="form-check-label" for="q{{ question.id }}_3">
                                {{ question.option3 }}
                            </label>
                        </div>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" name="answer_{{ question.id }}" 
                                   id="q{{ question.id }}_4" value="4">
                            <label class="form-check-label" for="q{{ question.id }}_4">
                                {{ question.option4 }}
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}

            <div class="d-grid gap-2 d-md-flex justify-content-md-end mb-4">
                <button type="submit" class="btn btn-primary">Submit Quiz</button>
            </div>
        </form>
    </div>

    <script>
        // Timer functionality
        function startTimer(duration, display) {
            var timer = duration * 60;
            var minutes, seconds;
            
            var countdown = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                display.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(countdown);
                    document.getElementById('quizForm').submit();
                }
            }, 1000);
        }

        window.onload = function () {
            var duration = "{{ quiz.time_duration }}";
            var display = document.querySelector('#time');
            startTimer(duration, display);
        };

        // Form submission
        document.getElementById('quizForm').onsubmit = function(e) {
            e.preventDefault();
            
            // Collect all answers
            var answers = {};
            var questions = document.querySelectorAll('.question-card');
            
            questions.forEach(function(question, index) {
                var questionId = question.querySelector('input[type="radio"]').name.split('_')[1];
                var selectedAnswer = question.querySelector('input[type="radio"]:checked');
                
                if (selectedAnswer) {
                    answers[questionId] = selectedAnswer.value;
                }
            });

            // Store answers in session
            fetch('/quiz/save-answer', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({answers: answers})
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error saving answers: ' + data.error);
                } else {
                    // Create and submit a form to POST to submit_quiz
                    var submitForm = document.createElement('form');
                    submitForm.method = 'POST';
                    submitForm.action = "{{ url_for('submit_quiz') }}";
                    document.body.appendChild(submitForm);
                    submitForm.submit();
                }
            });
        };
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subject Management - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='/style.css') }}"> -->
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row">
            <div class="col-md-8">
                <h2>Subjects</h2>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Chapters</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for subject in subjects %}
                            <tr>
                                <td>{{ subject.name }}</td>
                                <td>{{ subject.description }}</td>
                                <td>{{ subject.chapters|length }}</td>
                                <td>
                                    <a href="{{ url_for('edit_subject', subject_id=subject.id) }}" class="btn btn-sm btn-primary">
                                        <i class="bi bi-pencil"></i> Edit
                                    </a>
                                    <form action="{{ url_for('delete_subject', subject_id=subject.id) }}" 
                                          method="POST" style="display: inline;"
                                          onsubmit="return confirm('Are you sure you want to delete this subject?')">
                                        <button type="submit" class="btn btn-sm btn-danger">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h3>Add New Subject</h3>
                    </div>
                    <div class="card-body">
                        <form method="POST">
                            <div class="mb-3">
                                <label for="name" class="form-label">Subject Name</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Subject</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Summary - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('admin_dashboard') }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quiz</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('summary') }}">Summary</a>
                    </li>
                </ul>
                <div class="ms-auto d-flex align-items-center">
                    <span class="text-light me-3">Welcome Admin</span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline-light">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2 class="mb-4">Summary Charts</h2>
        
        <div class="row">
            <!-- Subject-wise Top Scores -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Subject-wise Top Scores</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="topScoresChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Subject-wise Average Scores -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Subject-wise Average Scores</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="avgScoresChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Subject-wise User Attempts -->
            <div class="col-md-12 mt-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Subject-wise User Attempts</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="userAttemptsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Extract data from Jinja template
        const chartData = {
            labels: `{{ subject_data|map(attribute='name')|list|tojson|safe }}`,
            topScores: `{{ subject_data|map(attribute='top_score')|list|tojson|safe }}`,
            avgScores: `{{ subject_data|map(attribute='avg_score')|list|tojson|safe }}`,
            attempts: `{{ subject_data|map(attribute='attempts')|list|tojson|safe }}`
        };

        // Parse the JSON data
        const labels = JSON.parse(chartData.labels);
        const topScores = JSON.parse(chartData.topScores);
        const avgScores = JSON.parse(chartData.avgScores);
        const attempts = JSON.parse(chartData.attempts);

        // Common chart colors
        const colors = {
            backgroundColor: [
                'rgba(54, 162, 235, 0.5)',  // Blue
                'rgba(75, 192, 192, 0.5)',  // Green
                'rgba(255, 99, 132, 0.5)',  // Pink
                'rgba(255, 206, 86, 0.5)',  // Yellow
                'rgba(153, 102, 255, 0.5)', // Purple
                'rgba(255, 159, 64, 0.5)'   // Orange
            ],
            borderColor: [
                'rgba(54, 162, 235, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(255, 99, 132, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ]
        };

        // Common bar chart options
        const barChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            }
        };

        // Subject-wise top scores chart
        const topScoresCtx = document.getElementById('topScoresChart').getContext('2d');
        new Chart(topScoresCtx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    data: topScores,
                    backgroundColor: colors.backgroundColor,
                    borderColor: colors.borderColor,
                    borderWidth: 1
                }]
            },
            options: barChartOptions
        });

        // Subject-wise average scores chart
        const avgScoresCtx = document.getElementById('avgScoresChart').getContext('2d');
        new Chart(avgScoresCtx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    data: avgScores,
                    backgroundColor: colors.backgroundColor,
                    borderColor: colors.borderColor,
                    borderWidth: 1
                }]
            },
            options: barChartOptions
        });

        // Subject-wise user attempts chart
        const userAttemptsCtx = document.getElementById('userAttemptsChart').getContext('2d');
        new Chart(userAttemptsCtx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: attempts,
                    backgroundColor: colors.backgroundColor,
                    borderColor: colors.borderColor,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right'
                    }
                }
            }
        });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Scores - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('dashboard') }}">Quiz Master</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dashboard') }}">
                            <i class="bi bi-house-door"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('user_scores') }}">
                            <i class="bi bi-trophy"></i> My Scores
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_summary') }}">
                            <i class="bi bi-graph-up"></i> Summary
                        </a>
                    </li>
                </ul>
                <div class="ms-auto">
                    <span class="text-light me-3">Welcome, {{ current_user.full_name }}</span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline-light">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row mb-4">
            <div class="col">
                <h2>My Quiz Scores</h2>
            </div>
            <div class="col-auto">
                <form class="d-flex" method="get">
                    <input type="date" name="date" class="form-control me-2" value="{{ request.args.get('date', '') }}">
                    <button type="submit" class="btn btn-primary">Filter</button>
                    {% if request.args.get('date') %}
                        <a href="{{ url_for('user_scores') }}" class="btn btn-secondary ms-2">Clear</a>
                    {% endif %}
                </form>
            </div>
        </div>
        
    
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Subject</th>
                                <th>Chapter</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if scores %}
                                {% for score in scores %}
                                <tr>
                                    <td>{{ score.time_stamp_of_attempt.strftime('%Y-%m-%d %H:%M') }}</td>
                                    <td>{{ score.get_quiz_details().subject }}</td>
                                    <td>{{ score.get_quiz_details().chapter }}</td>
                                    <td>{{ score.score }}%</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="4" class="text-center">No scores found</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Summary - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li> -->
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li> -->
                    <!-- <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('manage_users') }}">Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('summary') }}">Summary</a>
                    </li> -->
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dashboard') }}">
                            <i class="bi bi-house-door"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('user_scores') }}">
                            <i class="bi bi-trophy"></i> Scores
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Your Performance Summary</h2>

    <!-- Overall Statistics -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Overall Statistics</h5>
                    <p class="card-text">
                        Total Attempts: {{ total_attempts }}<br>
                        Average Score: {{ avg_score }}%
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Subject-wise Performance</h5>
                    <canvas id="subjectChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Attempts -->
    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">Recent Quiz Attempts</h5>
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Subject</th>
                            <th>Chapter</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for score in recent_scores %}
                        <tr>
                            <td>{{ score.time_stamp_of_attempt.strftime('%Y-%m-%d %H:%M') }}</td>
                            <td>{{ score.quiz.chapter.subject.name }}</td>
                            <td>{{ score.quiz.chapter.name }}</td>
                            <td>{{ score.score }}%</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Subject-wise Statistics -->
    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">Subject-wise Statistics</h5>
            <div class="accordion" id="subjectAccordion">
                {% for stat in subject_stats %}
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                data-bs-target="#subject{{ loop.index }}">
                            {{ stat.name }} ({{ stat.attempts }} attempts, Avg: {{ stat.avg_score }}%)
                        </button>
                    </h2>
                    <div id="subject{{ loop.index }}" class="accordion-collapse collapse" data-bs-parent="#subjectAccordion">
                        <div class="accordion-body">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Chapter</th>
                                        <th>Score</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for score in stat.scores %}
                                    <tr>
                                        <td>{{ score.date }}</td>
                                        <td>{{ score.quiz_name }}</td>
                                        <td>{{ score.score }}%</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('subjectChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: JSON.parse('{{ subject_labels | tojson | safe }}'),
            datasets: [{
                label: 'Number of Attempts',
                data: JSON.parse('{{ subject_attempts | tojson | safe }}'),
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 0.5)',
                borderWidth: 0.5,
                barPercentage: 0.3,  // Adjusts individual bar width (lower means thinner bars)
                categoryPercentage: 0.5  // Adjusts space between bars in a category 
            }, {
                label: 'Average Score (%)',
                data: JSON.parse('{{ subject_scores | tojson | safe }}'),
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderColor: 'rgba(255, 99, 132, 0.5)',
                borderWidth: 0.5,
                barPercentage: 0.3,  // Adjusts individual bar width (lower means thinner bars)
                categoryPercentage: 0.5  // Adjusts space between bars in a category 
            }]
        },
        options: {
            responsive: true,
            // maintainAspectRatio: false,
            aspectRatio: 5, 
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
});
</script>
{% endblock %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management - Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('admin_dashboard') }}">Quiz Master Admin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_subjects') }}">Subjects</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_chapters') }}">Chapters</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('manage_quizzes') }}">Quizzes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('manage_users') }}">Users</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('summary') }}">Summary</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row mb-4">
            <div class="col-md-6">
                <h2>User Management</h2>
            </div>
            <div class="col-md-6">
                <form class="d-flex" method="GET">
                    <input class="form-control me-2" type="search" placeholder="Search users..." 
                           name="search" value="{{ request.args.get('search', '') }}">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Qualification</th>
                                <th>Date of Birth</th>
                                <th>Quiz Attempts</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td>{{ user.full_name }}</td>
                                <td>{{ user.email }}</td>
                                <td>{{ user.qualification }}</td>
                                <td>
                                    {% if user.date_of_birth %}
                                        {{ user.date_of_birth.strftime('%Y-%m-%d') }}
                                    {% else %}
                                        Not provided
                                    {% endif %}
                                </td>
                                <td>{{ user.scores|length }}</td>
                                <td>
                                    {% if not user.is_admin %}
                                    <form action="{{ url_for('delete_user', user_id=user.id) }}" 
                                          method="POST" style="display: inline;"
                                          onsubmit="return confirm('Are you sure you want to delete this user?')">
                                        <button type="submit" class="btn btn-sm btn-danger">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </form>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Quiz - Quiz Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='/admin.css') }}">
    <style>
        .navbar {
            background-color: #2c3e50 !important;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover, .nav-link.active {
            color: white !important;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Quiz Details</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">ID:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.id }}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">Subject:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.chapter.subject.name }}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">Chapter:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.chapter.name }}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">Number of Questions:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.questions|length }}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">Scheduled Date:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.date_of_quiz.strftime('%d/%m/%Y %H:%M') }}</span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label class="form-label text-primary">Duration:</label>
                    </div>
                    <div class="col-md-9">
                        <span>{{ quiz.time_duration }} minutes</span>
                    </div>
                </div>
            </div>
            <div class="card-footer text-center">
                <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 